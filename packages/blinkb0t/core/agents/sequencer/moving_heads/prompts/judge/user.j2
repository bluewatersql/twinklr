Evaluate the following choreography plan:

## Plan to Judge

{{ plan | tojson(indent=2) }}

## Musical Context

{{ context.song_structure | tojson(indent=2) }}

{% if context.get('audio_features') %}
**Energy Profile**: {{ context.audio_features.get('energy_summary', 'Not available') }}
**Key Moments**: {{ context.audio_features.get('key_moments', []) | tojson }}
{% endif %}

## Available Templates

{% if context.get('available_templates') %}
{{ context.available_templates | tojson }}
{% else %}
No template library provided. Cannot validate template IDs.
{% endif %}

{% if iteration > 1 %}
## Iteration Context

This is iteration {{ iteration }}. Previous feedback:
{% for item in previous_feedback %}
- {{ item }}
{% endfor %}

Has the planner addressed the feedback effectively?
{% endif %}

## Evaluation Instructions

Judge this choreography plan across all criteria:

1. **Technical Validation (Phase 1)**: First verify completeness, timing, coverage, and consistency
2. **Musical Synchronization**: Does it serve the music?
3. **Visual Interest**: Is it engaging and varied?
4. **Flow and Transitions**: Does it feel cohesive?
5. **Creative Template Use**: Are templates used effectively?
6. **Energy Arc**: Does the overall energy make sense?

Remember: If technically invalid, return HARD_FAIL immediately. Otherwise, evaluate creative quality.

## Required Output Format

Provide your evaluation matching this schema:

```json
{{ response_schema }}
```
