{"role": "user", "content": "Section: chorus_1 (HIGH energy, BUSY motion, ABSTRACT style)\nPrimary targets: MEGA_TREE\nBounds: 48.0s to 64.0s\n\nThemeRef (COPY EXACTLY):\n{\n  \"theme_id\": \"theme.holiday.traditional\",\n  \"scope\": \"SECTION\",\n  \"tags\": [\"celebratory\"],\n  \"palette_id\": null\n}\n\nPalette (COPY EXACTLY):\n{\n  \"palette_id\": \"core.christmas_traditional\",\n  \"role\": \"PRIMARY\"\n}\n\nMotif IDs (COPY EXACTLY): sparkles, bells, starburst\n\nCreate coordination plan."}
{"role": "assistant", "content": "{\n  \"section_id\": \"chorus_1\",\n  \"theme\": {\n    \"theme_id\": \"theme.holiday.traditional\",\n    \"scope\": \"SECTION\",\n    \"tags\": [\n      \"celebratory\"\n    ],\n    \"palette_id\": null\n  },\n  \"palette\": {\n    \"palette_id\": \"core.christmas_traditional\",\n    \"role\": \"PRIMARY\"\n  },\n  \"motif_ids\": [\n    \"sparkles\",\n    \"bells\",\n    \"starburst\"\n  ],\n  \"lane_plans\": [\n    {\n      \"lane\": \"BASE\",\n      \"target_roles\": [\n        \"BACKGROUND\"\n      ],\n      \"coordination_plans\": [\n        {\n          \"coordination_mode\": \"UNIFIED\",\n          \"targets\": [\n            {\n              \"type\": \"zone\",\n              \"id\": \"HOUSE\"\n            }\n          ],\n          \"placements\": [\n            {\n              \"placement_id\": \"chorus_base_house_glow\",\n              \"target\": {\n                \"type\": \"zone\",\n                \"id\": \"HOUSE\"\n              },\n              \"template_id\": \"gtpl_base_glow_warm\",\n              \"start\": {\n                \"bar\": 1,\n                \"beat\": 1\n              },\n              \"duration\": \"SECTION\",\n              \"intensity\": \"SOFT\"\n            }\n          ]\n        }\n      ]\n    },\n    {\n      \"lane\": \"RHYTHM\",\n      \"target_roles\": [\n        \"MID\"\n      ],\n      \"coordination_plans\": [\n        {\n          \"coordination_mode\": \"SEQUENCED\",\n          \"targets\": [\n            {\n              \"type\": \"group\",\n              \"id\": \"ARCHES\"\n            },\n            {\n              \"type\": \"group\",\n              \"id\": \"CANDY_CANES\"\n            }\n          ],\n          \"window\": {\n            \"template_id\": \"gtpl_rhythm_chase_single\",\n            \"start\": {\n              \"bar\": 1,\n              \"beat\": 1\n            },\n            \"end\": {\n              \"bar\": 5,\n              \"beat\": 1\n            },\n            \"intensity\": \"STRONG\"\n          },\n          \"config\": {\n            \"group_order\": [\n              \"ARCHES\",\n              \"CANDY_CANES\"\n            ],\n            \"step_unit\": \"BEATS\",\n            \"step_duration\": 2\n          }\n        }\n      ]\n    },\n    {\n      \"lane\": \"ACCENT\",\n      \"target_roles\": [\n        \"HERO\"\n      ],\n      \"coordination_plans\": [\n        {\n          \"coordination_mode\": \"UNIFIED\",\n          \"targets\": [\n            {\n              \"type\": \"group\",\n              \"id\": \"MEGA_TREE\"\n            }\n          ],\n          \"placements\": [\n            {\n              \"placement_id\": \"chorus_mega_tree_hit_1\",\n              \"target\": {\n                \"type\": \"group\",\n                \"id\": \"MEGA_TREE\"\n              },\n              \"template_id\": \"gtpl_accent_burst_big\",\n              \"start\": {\n                \"bar\": 1,\n                \"beat\": 1\n              },\n              \"duration\": \"HIT\",\n              \"intensity\": \"PEAK\"\n            },\n            {\n              \"placement_id\": \"chorus_mega_tree_hit_2\",\n              \"target\": {\n                \"type\": \"group\",\n                \"id\": \"MEGA_TREE\"\n              },\n              \"template_id\": \"gtpl_accent_burst_big\",\n              \"start\": {\n                \"bar\": 2,\n                \"beat\": 1\n              },\n              \"duration\": \"HIT\",\n              \"intensity\": \"PEAK\"\n            },\n            {\n              \"placement_id\": \"chorus_mega_tree_hit_3\",\n              \"target\": {\n                \"type\": \"group\",\n                \"id\": \"MEGA_TREE\"\n              },\n              \"template_id\": \"gtpl_accent_burst_big\",\n              \"start\": {\n                \"bar\": 3,\n                \"beat\": 1\n              },\n              \"duration\": \"HIT\",\n              \"intensity\": \"PEAK\"\n            }\n          ]\n        }\n      ]\n    }\n  ],\n  \"deviations\": []\n}"}
{"role": "user", "content": "What's wrong with this plan?\n\n{\n  \"section_id\": \"verse_1\",\n  \"theme\": {\n    \"theme_id\": \"MISSING\",\n    \"scope\": \"SECTION\",\n    \"tags\": []\n  },\n  \"palette\": {\n    \"palette_id\": \"UNSPECIFIED_FROM_MACROPLAN\"\n  },\n  \"motif_ids\": [],\n  \"lane_plans\": [...]\n}"}
{"role": "assistant", "content": "❌ INVALID: Using placeholders instead of copying provided values.\n\nProblems:\n1) theme.theme_id = \"MISSING\" — must copy the exact ThemeRef object from the prompt\n2) palette.palette_id = \"UNSPECIFIED_FROM_MACROPLAN\" — must copy the exact palette object from the prompt\n3) motif_ids = [] — must copy the motif_ids from the prompt\n\nFix: Copy ThemeRef + Palette JSON verbatim and include motif_ids (>= 1). Never use placeholders."}
{"role": "user", "content": "What's wrong with these BASE placements on the same group?\n\n{\n  \"lane\": \"BASE\",\n  \"coordination_plans\": [{\n    \"coordination_mode\": \"UNIFIED\",\n    \"targets\": [{\"type\": \"group\", \"id\": \"OUTLINE\"}],\n    \"placements\": [\n      {\"placement_id\": \"base_outline_main\", \"target\": {\"type\": \"group\", \"id\": \"OUTLINE\"}, \"template_id\": \"gtpl_base_shimmer_radial\", \"start\": {\"bar\": 1, \"beat\": 1}, \"duration\": \"EXTENDED\", \"intensity\": \"SOFT\"},\n      {\"placement_id\": \"base_outline_dip\", \"target\": {\"type\": \"group\", \"id\": \"OUTLINE\"}, \"template_id\": \"gtpl_base_candle_flicker\", \"start\": {\"bar\": 12, \"beat\": 1}, \"duration\": \"PHRASE\", \"intensity\": \"WHISPER\"},\n      {\"placement_id\": \"base_outline_return\", \"target\": {\"type\": \"group\", \"id\": \"OUTLINE\"}, \"template_id\": \"gtpl_base_shimmer_radial\", \"start\": {\"bar\": 14, \"beat\": 1}, \"duration\": \"EXTENDED\", \"intensity\": \"SOFT\"}\n    ]\n  }]\n}"}
{"role": "assistant", "content": "❌ TARGET_SELF_OVERLAP: Three placements on the SAME target (group:OUTLINE) in the same lane.\n\nEXTENDED duration spans many bars. The \"main\" EXTENDED placement (bar 1) likely runs through bar 12+, overlapping the \"dip\" at bar 12. Then the \"dip\" PHRASE overlaps the \"return\" EXTENDED at bar 14.\n\nThe rule: **The same target must NOT overlap itself in a lane.** When placing multiple effects on one group, their time ranges must be disjoint.\n\nFix — use ONE placement with SECTION duration for a continuous BASE effect:\n```json\n{\"placement_id\": \"base_outline_full\", \"target\": {\"type\": \"group\", \"id\": \"OUTLINE\"}, \"template_id\": \"gtpl_base_shimmer_radial\", \"start\": {\"bar\": 1, \"beat\": 1}, \"duration\": \"SECTION\", \"intensity\": \"SOFT\"}\n```\n\nIf you need a mid-section transition on the same group, use a **different target type** (e.g., zone:HOUSE) for one of them so the renderer blends them, or split into EXACTLY disjoint time ranges using short durations:\n- Placement A: bar 1, PHRASE (covers bars 1-4)\n- Placement B: bar 5, PHRASE (covers bars 5-8) — starts AFTER A ends\n\nNever assume durations are short enough to avoid overlap — when in doubt, use SECTION duration for BASE."}
{"role": "user", "content": "What intensity level should I use for a BUILD section with HIGH energy targeting MEGA_TREE?"}
{"role": "assistant", "content": "For a BUILD section with HIGH energy:\n\n- BASE (BACKGROUND): SOFT → MED\n- RHYTHM (MID): MED → STRONG\n- ACCENT (HERO): STRONG (use PEAK only for select hits)\n\nExample:\n```json\n{\"placement_id\":\"mega_tree_build\",\"target\":{\"type\":\"group\",\"id\":\"MEGA_TREE\"},\"template_id\":\"gtpl_accent_pulse_hard\",\"start\":{\"bar\":1,\"beat\":1},\"duration\":\"BURST\",\"intensity\":\"STRONG\"}\n```"}
{"role": "user", "content": "What's wrong with this template selection?\n\n{\n  \"lane\": \"BASE\",\n  \"coordination_plans\": [{\n    \"placements\": [{\n      \"template_id\": \"gtpl_rhythm_strobe_soft\",\n      \"intensity\": \"MED\"\n    }]\n  }]\n}"}
{"role": "assistant", "content": "❌ INVALID: Lane/template mismatch.\n\ngtpl_rhythm_* templates are RHYTHM-lane templates. BASE lane must use BASE-compatible templates (e.g., gtpl_base_*). Pick a template whose compatible_lanes includes BASE."}
{"role": "user", "content": "What's wrong with these ACCENT placements?\n\n{\n  \"lane\": \"ACCENT\",\n  \"coordination_plans\": [{\n    \"coordination_mode\": \"UNIFIED\",\n    \"targets\": [{\"type\": \"group\", \"id\": \"MEGA_TREE\"}, {\"type\": \"group\", \"id\": \"STARS\"}],\n    \"placements\": [\n      {\"target\": {\"type\": \"group\", \"id\": \"MEGA_TREE\"}, \"template_id\": \"gtpl_accent_burst_big\", \"start\": {\"bar\": 2, \"beat\": 1}, \"duration\": \"BURST\", \"intensity\": \"PEAK\"},\n      {\"target\": {\"type\": \"group\", \"id\": \"STARS\"}, \"template_id\": \"gtpl_accent_burst_big\", \"start\": {\"bar\": 2, \"beat\": 1}, \"duration\": \"BURST\", \"intensity\": \"PEAK\"}\n    ]\n  }]\n}"}
{"role": "assistant", "content": "❌ PROBLEMATIC: Peak competition.\n\nBoth groups hit PEAK on the same beat, creating visual conflict.\n\nFix:\n- Keep ONE group at PEAK at a time (usually the HERO group)\n- Stagger the other by 1+ beat and/or drop it to STRONG\n\nExample:\n```json\n{\"target\":{\"type\":\"group\",\"id\":\"MEGA_TREE\"},\"start\":{\"bar\":2,\"beat\":1},\"duration\":\"BURST\",\"intensity\":\"PEAK\"},\n{\"target\":{\"type\":\"group\",\"id\":\"STARS\"},\"start\":{\"bar\":2,\"beat\":3},\"duration\":\"HIT\",\"intensity\":\"STRONG\"}\n```"}
{"role": "user", "content": "What effect duration should I use for a quick beat hit accent?"}
{"role": "assistant", "content": "Use **HIT** duration for a quick beat hit accent.\n\nExample:\n```json\n{\"placement_id\":\"beat_accent\",\"target\":{\"type\":\"group\",\"id\":\"MEGA_TREE\"},\"template_id\":\"gtpl_accent_flash\",\"start\":{\"bar\":2,\"beat\":3},\"duration\":\"HIT\",\"intensity\":\"STRONG\"}\n```"}
{"role": "user", "content": "How should I target all HOUSE groups at once for a BASE wash?"}
{"role": "assistant", "content": "Use a **zone target** to apply an effect to all groups tagged with that zone:\n\n```json\n{\n  \"coordination_mode\": \"UNIFIED\",\n  \"targets\": [{\"type\": \"zone\", \"id\": \"HOUSE\"}],\n  \"placements\": [\n    {\n      \"placement_id\": \"base_house_wash\",\n      \"target\": {\"type\": \"zone\", \"id\": \"HOUSE\"},\n      \"template_id\": \"gtpl_base_glow_warm\",\n      \"start\": {\"bar\": 1, \"beat\": 1},\n      \"duration\": \"SECTION\",\n      \"intensity\": \"SOFT\"\n    }\n  ]\n}\n```\n\nThe renderer expands zone:HOUSE to all HOUSE-tagged groups (OUTLINE, WINDOWS, WREATHS). You do NOT need to list individual groups.\n\nValid zones come from the \"Available Zones\" section in the display graph."}
{"role": "user", "content": "What's wrong with using PEAK intensity in a LOW energy section?"}
{"role": "assistant", "content": "⚠️ Energy mismatch.\n\nPEAK in a LOW energy section usually feels like visual shouting.\n\nFix: Prefer WHISPER/SOFT/MED, with rare STRONG hits only on key moments. Avoid PEAK unless there's an explicit musical justification."}
