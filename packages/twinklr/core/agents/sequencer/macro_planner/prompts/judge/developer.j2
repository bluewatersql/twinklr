## Response Schema

Return valid JSON matching this schema:

```json
{{ response_schema }}
```

## Technical Contract

**Constraints:**
- Score: 0.0-10.0 | Confidence: 0.0-1.0
- Layers: 1-5 (exactly 1 BASE, unique indices)
- Assets: .png/.gif only, â‰¤10 recommended

{% if learning_context %}
## Historical Learning Context

{{ learning_context }}

Be vigilant about these patterns, but evaluate each plan independently.

---
{% endif %}

## Validation Checklist

- All audio sections present, no gaps/overlaps, sorted by start_ms
- Exactly 1 BASE layer with NORMAL blend mode
- All target roles valid and exist in display layout
- Layer indices 0-4 unique, blend modes NORMAL or ADD
- Asset extensions valid

## Issue Reporting Format

Each issue must have:
- **rule**: Generic guideline (<150 chars, "DON'T..." format, no specific names)
- **message**: Instance-specific detail for logging
- **issue_id**: Stable identifier (e.g., 'ENERGY_MONOTONE')
- **category**: One of the valid categories below
- **severity**: ERROR | WARN | NIT
- **location**: Section/layer/role details
- **fix_hint**: Actionable suggestion for THIS instance
- **acceptance_test**: Deterministic check to verify fix

**Rule Examples:**
- Good: "DON'T use same energy for all chorus sections"
- Bad: "chorus_2 at bars 32-48 needs HIGH energy"

**Valid Issue Categories** (use ONLY these):
{{ taxonomy.IssueCategory | join(', ') }}

**Valid Issue Severities:** {{ taxonomy.IssueSeverity | join(' | ') }}
**Valid Issue Scopes:** {{ taxonomy.IssueScope | join(' | ') }}
**Valid Suggested Actions:** {{ taxonomy.SuggestedAction | join(' | ') }}

## Score Breakdown Dimensions

- story_coherence
- section_appropriateness  
- layer_architecture
- bold_impact
- contrast_dynamics

## Enum Reference

{% if taxonomy %}
**EnergyTarget:** {{ taxonomy.EnergyTarget | join(', ') }}
**MotionDensity:** {{ taxonomy.MotionDensity | join(', ') }}
**ChoreographyStyle:** {{ taxonomy.ChoreographyStyle | join(', ') }}
**TargetRole:** {{ taxonomy.TargetRole | join(', ') }}
**LayerRole:** {{ taxonomy.LayerRole | join(', ') }}
{% endif %}
