pack_id: macro_judge.v2
version: 2.1.0
agent_type: judge
supports_iteration: true
max_iterations: 3

templates:
  system: system.j2
  user: user.j2
  developer: developer.j2

variables:
  - name: audio_profile
    description: Full AudioProfileModel for the song
    required: true
  - name: display_groups
    description: List of available display groups with role keys
    required: true
  - name: macro_plan
    description: MacroPlan to evaluate
    required: true
  - name: iteration
    description: Current iteration number (starts at 1)
    required: true
  - name: taxonomy
    description: Dict of enum names to value lists (auto-injected)
    required: true
  - name: response_schema
    description: JSON schema for JudgeVerdict (auto-injected)
    required: true
  - name: lyric_context
    description: Optional LyricContextModel with narrative/thematic analysis
    required: false
  - name: theme_catalog
    description: Optional list of allowed ThemeDefinition summaries (theme_id/title)
    required: false

  # NEW: for deterministic id validation + better feedback
  - name: motif_catalog
    description: Motif catalog (MotifSpec list or mapping) used to validate section motif_ids
    required: false
  - name: palette_catalog
    description: Palette catalog (list of palette_ids or summary objects) used to validate palette ids
    required: false
